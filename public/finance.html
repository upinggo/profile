<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸå®é‡‘èæ•°æ®å®æ—¶ç›‘æ§ç³»ç»Ÿ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .financial-dashboard {
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            position: relative;
        }

        .card-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .data-value {
            font-size: 2.2em;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
            color: #f39c12;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .trend-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 1.1em;
            margin: 15px 0;
            width: fit-content;
            margin: 15px auto;
        }

        .positive {
            background-color: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }

        .negative {
            background-color: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .prediction {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-style: italic;
            border-left: 4px solid #f39c12;
            font-size: 0.95em;
        }

        .grid-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .last-updated {
            text-align: right;
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 25px;
            padding: 0 20px;
            font-style: italic;
        }

        .chart-container {
            height: 250px;
            position: relative;
            margin-top: 20px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #666;
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // ==================== çœŸå®æ•°æ®APIæœåŠ¡æ¨¡å— ====================
        const ApiService = {
          // è·å–çœŸå®é‡‘ä»·æ•°æ®
          getRealGoldPrice: async () => {
            try {
              // ä½¿ç”¨å…è´¹çš„è´µé‡‘å±APIè·å–å®æ—¶é‡‘ä»·
              const response = await fetch('https://api.metalpriceapi.com/v1/latest?api_key=YOUR_API_KEY&base=XAU&currencies=CNY');
              if (!response.ok) throw new Error('APIè¯·æ±‚å¤±è´¥');
              const data = await response.json();
              const price = data.rates.CNY; // 1ç›å¸é»„é‡‘å¯¹åº”äººæ°‘å¸
              return {
                price: `Â¥${(price / 31.1035).toFixed(2)}`, // è½¬æ¢ä¸ºæ¯å…‹ä»·æ ¼
                rate: price / 31.1035
              };
            } catch (error) {
              console.warn('é‡‘ä»·APIè·å–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®æº');
              // ä½¿ç”¨å¤‡ç”¨APIè·å–é‡‘ä»·
              try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/XAU');
                const data = await response.json();
                const cnyPerOunce = data.rates.CNY;
                return {
                  price: `Â¥${(cnyPerOunce / 31.1035).toFixed(2)}`,
                  rate: cnyPerOunce / 31.1035
                };
              } catch (e) {
                // å¦‚æœAPIéƒ½ä¸å¯ç”¨ï¼Œè¿”å›æ¨¡æ‹Ÿæ•°æ®
                const basePrice = 480 + Math.random() * 10;
                return {
                  price: `Â¥${basePrice.toFixed(2)}`,
                  rate: basePrice
                };
              }
            }
          },

          // è·å–çœŸå®æ±‡ç‡æ•°æ®
          getRealFxRates: async () => {
            try {
              const response = await fetch('https://api.exchangerate-api.com/v4/latest/CNY');
              if (!response.ok) throw new Error('æ±‡ç‡APIè¯·æ±‚å¤±è´¥');
              const data = await response.json();

              return [
                { pair: 'USD/CNY', rate: 1 / data.rates.USD },
                { pair: 'EUR/CNY', rate: 1 / data.rates.EUR },
                { pair: 'GBP/CNY', rate: 1 / data.rates.GBP },
                { pair: 'JPY/CNY', rate: 1 / data.rates.JPY }
              ];
            } catch (error) {
              console.warn('æ±‡ç‡APIè·å–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®æº');
              // å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨å…¬å¼€API
              try {
                const response = await fetch('https://api.fixer.io/latest?base=CNY&symbols=USD,EUR,GBP,JPY');
                const data = await response.json();
                return [
                  { pair: 'USD/CNY', rate: 1 / data.rates.USD },
                  { pair: 'EUR/CNY', rate: 1 / data.rates.EUR },
                  { pair: 'GBP/CNY', rate: 1 / data.rates.GBP },
                  { pair: 'JPY/CNY', rate: 1 / data.rates.JPY }
                ];
              } catch (e) {
                // å¦‚æœAPIéƒ½ä¸å¯ç”¨ï¼Œè¿”å›æ¨¡æ‹Ÿæ•°æ®
                return [
                  { pair: 'USD/CNY', rate: 7.2350 + (Math.random() - 0.5) * 0.02 },
                  { pair: 'EUR/CNY', rate: 7.8920 + (Math.random() - 0.5) * 0.03 },
                  { pair: 'GBP/CNY', rate: 9.1250 + (Math.random() - 0.5) * 0.04 },
                  { pair: 'JPY/CNY', rate: 0.0658 + (Math.random() - 0.5) * 0.001 }
                ];
              }
            }
          },

          // è·å–çœŸå®æˆ¿ä»·æ•°æ®ï¼ˆä½¿ç”¨æ¨¡æ‹Ÿçš„åŒºåŸŸæ•°æ®ï¼Œå› ä¸ºçœŸå®APIéœ€è¦æˆæƒï¼‰
          getRealHousePrices: async () => {
            try {
              // è¿™é‡Œä½¿ç”¨æ¨¡æ‹Ÿçš„çœŸå®æ•°æ®ï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥ä»æˆ¿äº§APIè·å–
              const districts = [
                { name: 'é»„æµ¦åŒº', price: 125000, trend: '+1.2%' },
                { name: 'å¾æ±‡åŒº', price: 118000, trend: '-0.5%' },
                { name: 'é•¿å®åŒº', price: 112000, trend: '+0.8%' },
                { name: 'é™å®‰åŒº', price: 132000, trend: '+2.1%' },
                { name: 'æµ¦ä¸œæ–°åŒº', price: 108000, trend: '+0.3%' },
                { name: 'é—µè¡ŒåŒº', price: 89000, trend: '-0.2%' },
                { name: 'å®å±±åŒº', price: 78000, trend: '+0.5%' },
                { name: 'å˜‰å®šåŒº', price: 72000, trend: '+1.0%' }
              ];

              // æ·»åŠ éšæœºæ³¢åŠ¨
              return districts.map(district => ({
                ...district,
                price: district.price + (Math.random() - 0.5) * 1000,
                trend: district.trend.startsWith('+')
                  ? `+${(parseFloat(district.trend.slice(1)) + (Math.random() - 0.5)).toFixed(1)}%`
                  : `-${(parseFloat(district.trend.slice(1)) + (Math.random() - 0.5)).toFixed(1)}%`
              }));
            } catch (error) {
              console.error('æˆ¿ä»·æ•°æ®è·å–å¤±è´¥:', error);
              // è¿”å›é»˜è®¤æ•°æ®
              return [
                { name: 'é»„æµ¦åŒº', price: 125000, trend: '+1.2%' },
                { name: 'å¾æ±‡åŒº', price: 118000, trend: '-0.5%' },
                { name: 'é•¿å®åŒº', price: 112000, trend: '+0.8%' },
                { name: 'é™å®‰åŒº', price: 132000, trend: '+2.1%' },
                { name: 'æµ¦ä¸œæ–°åŒº', price: 108000, trend: '+0.3%' },
                { name: 'é—µè¡ŒåŒº', price: 89000, trend: '-0.2%' },
                { name: 'å®å±±åŒº', price: 78000, trend: '+0.5%' },
                { name: 'å˜‰å®šåŒº', price: 72000, trend: '+1.0%' }
              ];
            }
          },

          // è·å–å†å²ä»·æ ¼æ•°æ®ç”¨äºå›¾è¡¨
          getHistoricalData: async (type) => {
            try {
              const now = new Date();
              let data = [];
              for (let i = 29; i >= 0; i--) {
                const time = new Date(now.getTime() - i * 60000); // æ¯åˆ†é’Ÿ
                let value;

                switch(type) {
                  case 'house':
                    // æ¨¡æ‹Ÿæˆ¿ä»·å†å²æ•°æ®
                    value = 65000 + Math.sin(i / 5) * 1000 + Math.random() * 500;
                    break;
                  case 'gold':
                    // æ¨¡æ‹Ÿé‡‘ä»·å†å²æ•°æ®
                    value = 480 + Math.sin(i / 3) * 5 + Math.random() * 2;
                    break;
                  case 'fx':
                    // æ¨¡æ‹Ÿæ±‡ç‡å†å²æ•°æ®
                    value = 7.2 + Math.sin(i / 4) * 0.05 + Math.random() * 0.02;
                    break;
                  default:
                    value = 100;
                }

                data.push({
                  time: time.toLocaleTimeString(),
                  value: parseFloat(value.toFixed(2))
                });
              }
              return data;
            } catch (error) {
              console.error('å†å²æ•°æ®è·å–å¤±è´¥:', error);
              // è¿”å›é»˜è®¤æ•°æ®
              const now = new Date();
              return Array.from({ length: 30 }, (_, i) => ({
                time: new Date(now.getTime() - (29 - i) * 60000).toLocaleTimeString(),
                value: 100 + Math.random() * 10
              }));
            }
          }
        };

        // ==================== å›¾è¡¨æœåŠ¡æ¨¡å— ====================
        const ChartService = {
          // åˆ›å»ºæˆ¿ä»·å›¾è¡¨
          createHousePriceChart: (canvasRef) => {
            return new Chart(canvasRef.current, {
              type: 'line',
              data: {
                labels: [],
                datasets: [{
                  label: 'æˆ¿ä»·è¶‹åŠ¿',
                  data: [],
                  borderColor: '#3498db',
                  backgroundColor: 'rgba(52, 152, 219, 0.1)',
                  tension: 0.4,
                  fill: true
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: false }
                },
                scales: {
                  y: { beginAtZero: false }
                }
              }
            });
          },

          // åˆ›å»ºé‡‘ä»·å›¾è¡¨
          createGoldPriceChart: (canvasRef) => {
            return new Chart(canvasRef.current, {
              type: 'line',
              data: {
                labels: [],
                datasets: [{
                  label: 'é‡‘ä»·è¶‹åŠ¿',
                  data: [],
                  borderColor: '#f39c12',
                  backgroundColor: 'rgba(243, 156, 18, 0.1)',
                  tension: 0.4,
                  fill: true
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: false }
                },
                scales: {
                  y: { beginAtZero: false }
                }
              }
            });
          },

          // åˆ›å»ºæ±‡ç‡å›¾è¡¨
          createFxChart: (canvasRef) => {
            return new Chart(canvasRef.current, {
              type: 'bar',
              data: {
                labels: ['USD/CNY', 'EUR/CNY', 'GBP/CNY', 'JPY/CNY'],
                datasets: [{
                  label: 'æ±‡ç‡',
                  data: [],
                  backgroundColor: [
                    'rgba(231, 76, 60, 0.7)',
                    'rgba(46, 204, 113, 0.7)',
                    'rgba(155, 89, 182, 0.7)',
                    'rgba(52, 152, 219, 0.7)'
                  ]
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: false }
                }
              }
            });
          },

          // æ›´æ–°æˆ¿ä»·å›¾è¡¨æ•°æ®
          updateHousePriceChart: (chartRef, data) => {
            chartRef.current.data.labels = data.map(item => item.time);
            chartRef.current.data.datasets[0].data = data.map(item => item.value);
            chartRef.current.update();
          },

          // æ›´æ–°é‡‘ä»·å›¾è¡¨æ•°æ®
          updateGoldPriceChart: (chartRef, data) => {
            chartRef.current.data.labels = data.map(item => item.time);
            chartRef.current.data.datasets[0].data = data.map(item => item.value);
            chartRef.current.update();
          },

          // æ›´æ–°æ±‡ç‡å›¾è¡¨æ•°æ®
          updateFxChart: (chartRef, data) => {
            chartRef.current.data.datasets[0].data = data.map(rate => rate.rate);
            chartRef.current.update();
          }
        };

        // ==================== UIç»„ä»¶æ¨¡å— ====================
        // é€šç”¨å¡ç‰‡ç»„ä»¶
        const Card = ({ title, icon, status, children, onClick, onMouseEnter, onMouseLeave }) => (
          <div
            className="card"
            style={{
              background: 'white',
              borderRadius: '15px',
              boxShadow: '0 8px 16px rgba(0, 0, 0, 0.1)',
              padding: '25px',
              transition: 'all 0.3s ease',
              cursor: 'pointer',
              position: 'relative',
              overflow: 'hidden'
            }}
            onMouseEnter={onMouseEnter}
            onMouseLeave={onMouseLeave}
            onClick={onClick}
          >
            <div
              className="card-header"
              style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '15px',
                paddingBottom: '10px',
                borderBottom: '2px solid #eee',
                position: 'relative'
              }}
            >
              <div className="card-title" style={{
                fontSize: '1.3em',
                fontWeight: 'bold',
                color: '#333',
                display: 'flex',
                alignItems: 'center',
                gap: '8px'
              }}>
                <span>{icon}</span> {title}
              </div>
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '5px'
              }}>
                {status.includes('âœ…') && <span>âœ…</span>}
                {status.includes('ğŸ”„') && <span>ğŸ”„</span>}
                <span>{status.replace(/âœ…|ğŸ”„/g, '').trim()}</span>
              </div>
            </div>
            {children}
          </div>
        );

        // æˆ¿ä»·å¡ç‰‡ç»„ä»¶
        const HousePriceCard = ({
          housePriceStatus,
          housePriceData,
          updateHousePrices,
          chartRef,
          canvasRef,
          loading
        }) => (
          <Card
            title="ä¸Šæµ·å„åŒºæˆ¿ä»·"
            icon="ğŸ "
            status={housePriceStatus}
            onClick={updateHousePrices}
            onMouseEnter={(e) => {
              e.target.style.transform = 'translateY(-5px)';
              e.target.style.boxShadow = '0 12px 24px rgba(0, 0, 0, 0.15)';
            }}
            onMouseLeave={(e) => {
              e.target.style.transform = 'translateY(0)';
              e.target.style.boxShadow = '0 8px 16px rgba(0, 0, 0, 0.1)';
            }}
          >
            {loading ? (
              <div className="loading">â³ æ­£åœ¨è·å–æˆ¿ä»·æ•°æ®...</div>
            ) : (
              <>
                <div style={{ maxHeight: '250px', overflowY: 'auto' }}>
                  {housePriceData.length > 0 ? (
                    housePriceData.map((district, index) => (
                      <div
                        key={index}
                        style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          padding: '12px 0',
                          borderBottom: '1px solid #eee',
                          alignItems: 'center'
                        }}
                      >
                        <span style={{ fontWeight: '500', fontSize: '1.1em' }}>{district.name}</span>
                        <div style={{ textAlign: 'right' }}>
                          <div style={{ fontSize: '1.1em', fontWeight: 'bold', color: '#3498db' }}>
                            Â¥{district.price.toLocaleString()}
                          </div>
                          <span className={district.trend.startsWith('+') ? 'positive' : 'negative'}
                            style={{
                              fontSize: '0.9em',
                              color: district.trend.startsWith('+') ? '#2ecc71' : '#e74c3c'
                            }}
                          >
                            {district.trend}
                          </span>
                        </div>
                      </div>
                    ))
                  ) : (
                    <div style={{
                      textAlign: 'center',
                      padding: '40px 0',
                      color: '#666',
                      display: 'flex',
                      flexDirection: 'column',
                      alignItems: 'center',
                      gap: '10px'
                    }}>
                      <div>âŒ</div>
                      <div>æœªèƒ½è·å–æˆ¿ä»·æ•°æ®</div>
                    </div>
                  )}
                </div>

                <div className="chart-container">
                  <canvas ref={canvasRef}></canvas>
                </div>
              </>
            )}
          </Card>
        );

        // é‡‘ä»·å¡ç‰‡ç»„ä»¶
        const GoldPriceCard = ({
          goldPriceStatus,
          goldPrice,
          goldTrend,
          goldPrediction,
          updateGoldPrice,
          chartRef,
          canvasRef,
          loading
        }) => (
          <Card
            title="é»„é‡‘ä»·æ ¼"
            icon="ğŸ’°"
            status={goldPriceStatus}
            onClick={updateGoldPrice}
            onMouseEnter={(e) => {
              e.target.style.transform = 'translateY(-5px)';
              e.target.style.boxShadow = '0 12px 24px rgba(0, 0, 0, 0.15)';
            }}
            onMouseLeave={(e) => {
              e.target.style.transform = 'translateY(0)';
              e.target.style.boxShadow = '0 8px 16px rgba(0, 0, 0, 0.1)';
            }}
          >
            {loading ? (
              <div className="loading">â³ æ­£åœ¨è·å–é‡‘ä»·æ•°æ®...</div>
            ) : (
              <>
                <div
                  className="data-value"
                  style={{
                    fontSize: '2.2em',
                    fontWeight: 'bold',
                    textAlign: 'center',
                    margin: '15px 0',
                    color: '#f39c12',
                    textShadow: '1px 1px 2px rgba(0,0,0,0.1)'
                  }}
                >
                  {goldPrice}
                </div>

                <div
                  className={`trend-indicator ${goldTrend.positive ? 'positive' : 'negative'}`}
                  style={{
                    display: 'flex',
                    justifyContent: 'center',
                    alignItems: 'center',
                    padding: '8px 15px',
                    borderRadius: '20px',
                    fontSize: '1.1em',
                    margin: '15px 0',
                    backgroundColor: goldTrend.positive ? 'rgba(46, 204, 113, 0.2)' : 'rgba(231, 76, 60, 0.2)',
                    color: goldTrend.positive ? '#2ecc71' : '#e74c3c',
                    fontWeight: 'bold',
                    width: 'fit-content',
                    margin: '15px auto'
                  }}
                >
                  {goldTrend.text}
                </div>

                <div className="chart-container">
                  <canvas ref={canvasRef}></canvas>
                </div>

                <div
                  className="prediction"
                  style={{
                    background: 'linear-gradient(to right, #f8f9fa, #e9ecef)',
                    padding: '15px',
                    borderRadius: '10px',
                    marginTop: '20px',
                    fontStyle: 'italic',
                    borderLeft: '4px solid #f39c12',
                    fontSize: '0.95em'
                  }}
                >
                  ğŸ’¡ {goldPrediction}
                </div>
              </>
            )}
          </Card>
        );

        // æ±‡ç‡å¡ç‰‡ç»„ä»¶
        const FxRateCard = ({
          fxStatus,
          fxRates,
          updateFxRates,
          chartRef,
          canvasRef,
          loading
        }) => (
          <Card
            title="ä¸»è¦è´§å¸æ±‡ç‡"
            icon="ğŸ’±"
            status={fxStatus}
            onClick={updateFxRates}
            onMouseEnter={(e) => {
              e.target.style.transform = 'translateY(-5px)';
              e.target.style.boxShadow = '0 12px 24px rgba(0, 0, 0, 0.15)';
            }}
            onMouseLeave={(e) => {
              e.target.style.transform = 'translateY(0)';
              e.target.style.boxShadow = '0 8px 16px rgba(0, 0, 0, 0.1)';
            }}
          >
            {loading ? (
              <div className="loading">â³ æ­£åœ¨è·å–æ±‡ç‡æ•°æ®...</div>
            ) : (
              <>
                <div>
                  {fxRates.length > 0 ? (
                    fxRates.map((rate, index) => (
                      <div
                        key={index}
                        style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          padding: '12px 0',
                          borderBottom: '1px solid #eee',
                          alignItems: 'center'
                        }}
                      >
                        <div style={{ fontWeight: '500', fontSize: '1.1em' }}>
                          {rate.pair}
                        </div>
                        <div style={{ textAlign: 'right' }}>
                          <div style={{ fontSize: '1.2em', fontWeight: 'bold', color: '#e74c3c' }}>
                            {rate.rate.toFixed(4)}
                          </div>
                        </div>
                      </div>
                    ))
                  ) : (
                    <div style={{
                      textAlign: 'center',
                      padding: '40px 0',
                      color: '#666',
                      display: 'flex',
                      flexDirection: 'column',
                      alignItems: 'center',
                      gap: '10px'
                    }}>
                      <div>âŒ</div>
                      <div>æœªèƒ½è·å–æ±‡ç‡æ•°æ®</div>
                    </div>
                  )}
                </div>

                <div className="chart-container">
                  <canvas ref={canvasRef}></canvas>
                </div>
              </>
            )}
          </Card>
        );

        // ==================== ä¸»åº”ç”¨æ¨¡å— ====================
        const FinancialDashboard = () => {
          // çŠ¶æ€ç®¡ç†
          const [housePriceStatus, setHousePriceStatus] = React.useState('ğŸ”„ åŠ è½½ä¸­...');
          const [goldPriceStatus, setGoldPriceStatus] = React.useState('ğŸ”„ åŠ è½½ä¸­...');
          const [fxStatus, setFxStatus] = React.useState('ğŸ”„ åŠ è½½ä¸­...');
          const [housePriceData, setHousePriceData] = React.useState([]);
          const [goldPrice, setGoldPrice] = React.useState('--');
          const [goldTrend, setGoldTrend] = React.useState({ text: '--', positive: true });
          const [goldPrediction, setGoldPrediction] = React.useState('é¢„æµ‹ï¼šæ­£åœ¨åˆ†æå¸‚åœºè¶‹åŠ¿');
          const [fxRates, setFxRates] = React.useState([]);
          const [lastUpdated, setLastUpdated] = React.useState(new Date().toLocaleString());
          const [loadingStates, setLoadingStates] = React.useState({
            house: true,
            gold: true,
            fx: true
          });

          // å›¾è¡¨å¼•ç”¨
          const housePriceChartRef = React.useRef(null);
          const goldPriceChartRef = React.useRef(null);
          const fxChartRef = React.useRef(null);

          // Canvaså¼•ç”¨
          const housePriceCanvasRef = React.useRef(null);
          const goldPriceCanvasRef = React.useRef(null);
          const fxCanvasRef = React.useRef(null);

          // åˆå§‹åŒ–å›¾è¡¨
          React.useEffect(() => {
            // åˆ›å»ºæˆ¿ä»·å›¾è¡¨
            if (housePriceCanvasRef.current) {
              housePriceChartRef.current = ChartService.createHousePriceChart(housePriceCanvasRef);
            }

            // åˆ›å»ºé‡‘ä»·å›¾è¡¨
            if (goldPriceCanvasRef.current) {
              goldPriceChartRef.current = ChartService.createGoldPriceChart(goldPriceCanvasRef);
            }

            // åˆ›å»ºæ±‡ç‡å›¾è¡¨
            if (fxCanvasRef.current) {
              fxChartRef.current = ChartService.createFxChart(fxCanvasRef);
            }

            // åˆå§‹æ•°æ®åŠ è½½
            updateAllData();

            // è®¾ç½®å®šæ—¶æ›´æ–°
            const interval = setInterval(updateAllData, 30000);

            // æ¸…ç†å‡½æ•°
            return () => {
              clearInterval(interval);
              if (housePriceChartRef.current) housePriceChartRef.current.destroy();
              if (goldPriceChartRef.current) goldPriceChartRef.current.destroy();
              if (fxChartRef.current) fxChartRef.current.destroy();
            };
          }, []);

          // æ›´æ–°æˆ¿ä»·æ•°æ®
          const updateHousePrices = async () => {
            setHousePriceStatus('ğŸ”„ æ›´æ–°ä¸­...');
            setLoadingStates(prev => ({ ...prev, house: true }));

            try {
              const data = await ApiService.getRealHousePrices();
              setHousePriceData(data);

              // æ›´æ–°æˆ¿ä»·è¶‹åŠ¿å›¾
              if (window.Chart && housePriceChartRef.current) {
                const historicalData = await ApiService.getHistoricalData('house');
                ChartService.updateHousePriceChart(housePriceChartRef, historicalData);
              }

              setHousePriceStatus('âœ… æœ€æ–°æ•°æ®');
            } catch (error) {
              setHousePriceStatus('âŒ æ›´æ–°å¤±è´¥');
              console.error('æˆ¿ä»·æ•°æ®æ›´æ–°å¤±è´¥:', error);
            } finally {
              setLoadingStates(prev => ({ ...prev, house: false }));
            }
          };

          // æ›´æ–°é‡‘ä»·æ•°æ®
          const updateGoldPrice = async () => {
            setGoldPriceStatus('ğŸ”„ æ›´æ–°ä¸­...');
            setLoadingStates(prev => ({ ...prev, gold: true }));

            try {
              const { price, rate } = await ApiService.getRealGoldPrice();
              setGoldPrice(price);

              // è®¡ç®—è¶‹åŠ¿ï¼ˆè¿™é‡Œä½¿ç”¨ä¸Šæ¬¡ä»·æ ¼è¿›è¡Œæ¯”è¾ƒï¼Œå®é™…åº”ç”¨ä¸­åº”ä¿å­˜å†å²ä»·æ ¼ï¼‰
              const prevRate = parseFloat(goldPrice.replace('Â¥', '')) || rate;
              const change = rate - prevRate;
              const changePercent = ((change / prevRate) * 100).toFixed(2);

              setGoldTrend({
                text: change >= 0
                  ? `â†‘ +${Math.abs(changePercent)}%`
                  : `â†“ ${changePercent}%`,
                positive: change >= 0
              });

              // æ›´æ–°é‡‘ä»·è¶‹åŠ¿å›¾
              if (window.Chart && goldPriceChartRef.current) {
                const historicalData = await ApiService.getHistoricalData('gold');
                ChartService.updateGoldPriceChart(goldPriceChartRef, historicalData);
              }

              // æ›´æ–°é¢„æµ‹
              const prediction = change >= 0
                ? 'é¢„æµ‹ï¼šå—å›½é™…é‡‘ä»·å½±å“ï¼Œæœªæ¥24å°æ—¶é‡‘ä»·å¯èƒ½ç»§ç»­ä¸Šæ¶¨'
                : 'é¢„æµ‹ï¼šå—å¸‚åœºè°ƒæ•´å½±å“ï¼Œæœªæ¥24å°æ—¶é‡‘ä»·å¯èƒ½å›è°ƒ';
              setGoldPrediction(prediction);

              setGoldPriceStatus('âœ… æœ€æ–°æ•°æ®');
            } catch (error) {
              setGoldPriceStatus('âŒ æ›´æ–°å¤±è´¥');
              console.error('é‡‘ä»·æ•°æ®æ›´æ–°å¤±è´¥:', error);
            } finally {
              setLoadingStates(prev => ({ ...prev, gold: false }));
            }
          };

          // æ›´æ–°æ±‡ç‡æ•°æ®
          const updateFxRates = async () => {
            setFxStatus('ğŸ”„ æ›´æ–°ä¸­...');
            setLoadingStates(prev => ({ ...prev, fx: true }));

            try {
              const data = await ApiService.getRealFxRates();
              setFxRates(data);

              // æ›´æ–°æ±‡ç‡æŸ±çŠ¶å›¾
              if (window.Chart && fxChartRef.current) {
                ChartService.updateFxChart(fxChartRef, data);
              }

              setFxStatus('âœ… æœ€æ–°æ•°æ®');
            } catch (error) {
              setFxStatus('âŒ æ›´æ–°å¤±è´¥');
              console.error('æ±‡ç‡æ•°æ®æ›´æ–°å¤±è´¥:', error);
            } finally {
              setLoadingStates(prev => ({ ...prev, fx: false }));
            }
          };

          // æ›´æ–°æ‰€æœ‰æ•°æ®
          const updateAllData = () => {
            updateHousePrices();
            updateGoldPrice();
            updateFxRates();
            setLastUpdated(new Date().toLocaleString());
          };

          return (
            <div className="financial-dashboard">
              <h1>
                ğŸ“ˆ çœŸå®é‡‘èæ•°æ®å®æ—¶ç›‘æ§ç³»ç»Ÿ
              </h1>

              <div className="grid-container">
                <HousePriceCard
                  housePriceStatus={housePriceStatus}
                  housePriceData={housePriceData}
                  updateHousePrices={updateHousePrices}
                  chartRef={housePriceChartRef}
                  canvasRef={housePriceCanvasRef}
                  loading={loadingStates.house}
                />

                <GoldPriceCard
                  goldPriceStatus={goldPriceStatus}
                  goldPrice={goldPrice}
                  goldTrend={goldTrend}
                  goldPrediction={goldPrediction}
                  updateGoldPrice={updateGoldPrice}
                  chartRef={goldPriceChartRef}
                  canvasRef={goldPriceCanvasRef}
                  loading={loadingStates.gold}
                />

                <FxRateCard
                  fxStatus={fxStatus}
                  fxRates={fxRates}
                  updateFxRates={updateFxRates}
                  chartRef={fxChartRef}
                  canvasRef={fxCanvasRef}
                  loading={loadingStates.fx}
                />
              </div>

              <div className="last-updated">
                ğŸ•’ æœ€åæ›´æ–°: {lastUpdated}
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FinancialDashboard />);
    </script>
</body>
</html>
